上下文无关文法的化简
=====================================

# 传统上下文文法表达形式在实践中暴露的问题

## 第一个问题，由ε产生式带来的分析复杂度

在上面的文章中，我们广泛的采用ε符号来消除左递归和辅助语法分析。虽然ε表达式为我们构造文法带来了很大方便，但是对于分析文法的工作被极大的复杂化了。尤其是在3.2节制造一个demo文法解析器的过程中，求follow集的算法可谓是一改再改，实现上达到了聱牙佶屈的程度。这对于理解以及修正算法都是非常不利的。

所以如果能有一种方法，仅仅使用first集进行分析，消除follow集的影响，就可以极大的简化开发和维护工作，同时也方便大家学习理解。

## 第二个问题，维持无二义性带来的表状态开销

为了方便代码生成，我在3.2节的代码实现中使用了驱动表来实现自动机的控制。但在最开始设计文法的时候，为了保证文法无二义，使用了很多中间终结符来保证这个性质。这就导致本来一个很简单的展开，可能需要很多次中间展开才能最终落到一个终结符上。这一是带来了很大的内存开销；第二CPU本身也很难对表驱动这种结构的程序进行分支预测，更大的表无疑增加了CPU的运行负担；第三导致文法有问题的时候也很难通过debug快速排查问题所在。

所以需要一种既可以保证无二义，又能迅速进行分析，减小驱动表大小的方法。

## 第三个问题，无用产生式和符号

对于一门复杂的语言来说，由于本身千头万绪，加之人的精力有限；想要完全顾及到每个方面，一次性的设计好文法是不太可能的。因此在几个版本的修改之后，难免会有一些符号或者产生式在最终的语言中用不上，但是在文法定义中没有被删除。这些冗余代码也会被分析填入驱动表，甚至正常的分析产生AST类。这种分析了却用不上的文法是应该被剔除的。

# 化简上下文无关文法

## 1.消除ε产生式

## 2.去除单一产生式组

## 3.去除无用符号

## 4.消除直接与间接左递归